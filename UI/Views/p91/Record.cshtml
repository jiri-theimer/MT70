@model UI.Models.Record.p91Record
@inject BL.Factory _f

@{
    Model.PageTitle = _f.tra("Vyúčtování");
    Layout = "~/Views/Shared/_LayoutRecord.cshtml";
    Model.PageSymbol = BO.Symbol.p91();
}

@addTagHelper *, UI

<div class="tabs_container_record">
    <!-- Tab panes -->
    <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item onetab" role="presentation">
            <a id="link_tab1" class="nav-link" data-bs-toggle="tab" role="tab" href="#tab1">@_f.tra("Karta vyúčtování")</a>
        </li>
        <li class="nav-item onetab" role="presentation">
            <a id="link_tab2" class="nav-link" data-bs-toggle="tab" role="tab" href="#tab2">@_f.tra("Klient vyúčtování")</a>
        </li>
        <li class="nav-item onetab" role="presentation">
            <a id="link_tab3" class="nav-link" data-bs-toggle="tab" role="tab" href="#tab3">@_f.tra("Uživatelská pole") (@Model.ff1.VisibleInputsCount)</a>
        </li>
        <li class="nav-item onetab" role="presentation">
            <a id="link_tab4" class="nav-link" data-bs-toggle="tab" role="tab" href="#tab4">@_f.tra("Ostatní")</a>
        </li>

    </ul>
</div>


<div class="modal_record_container">
    <div class="tab-content">        
        <div class="tab-pane" id="tab1" role="tabpanel">
            <!-- Tab1 -->
            <div class="row">
                <label class="col-sm-1 col-md-2 col-form-label">@_f.tra("Typ faktury"):</label>
                <div class="col-sm-3 col-md-2">

                </div>
                <label class="col-sm-1 col-md-2 col-form-label">@_f.tra("Číslo faktury"):</label>
                <div class="col-sm-4 col-md-3">
                    @if (Model.CanEditRecordCode)
                    {
                        <myval value="@Model.Rec.p91Code" hoversymol="@_f.tra("Upravit kód")" hoverurl="javascript:_edit_code('p91',@Model.rec_pid)"></myval>
                    }
                    else
                    {
                        <myval value="@Model.Rec.p91Code"></myval>
                    }
                </div>
            </div>

            <div class="row my-2">
                <label class="col-sm-1 col-md-2 col-form-label">@_f.tra("Datum zdanitelného plnění"):</label>
                <div class="col-sm-3 col-md-2">
                    <mydate asp-for="Rec.p91DateSupply"></mydate>
                </div>

                <label class="col-sm-1 col-md-2 col-form-label">@_f.tra("Zaokrouhlovací pravidlo"):</label>
                <div class="col-sm-7 col-md-6">
                    <mycombo entity="p98Invoice_Round_Setting_Template" asp-for="Rec.p98ID" selectedtext="@Model.ComboP98Name"></mycombo>
                </div>
            </div>

            <div class="row my-2">
                <label class="col-sm-1 col-md-2 col-form-label">@_f.tra("Datum vystavení"):</label>
                <div class="col-sm-3 col-md-2">
                    <mydate asp-for="Rec.p91Date"></mydate>
                </div>

                <label class="col-sm-1 col-md-2 col-form-label recpagelabel">@_f.tra("Struktura cenového rozpisu"):</label>
                <div class="col-sm-4 col-md-3">
                    <mycombo entity="p80InvoiceAmountStructure" asp-for="Rec.p80ID" selectedtext="@Model.ComboP80Name"></mycombo>
                </div>
                <label class="col-sm-1 col-md-1 col-form-label recpagelabel">@_f.tra("Forma úhrady"):</label>
                <div class="col-sm-2 col-md-2">
                    <mycombo entity="j19PaymentType" asp-for="Rec.j19ID" selectedtext="@Model.ComboJ19Name"></mycombo>
                </div>
            </div>

            <div class="row my-2">
                <label class="col-sm-1 col-md-2 col-form-label">@_f.tra("Datum splatnosti"):</label>
                <div class="col-sm-3 col-md-2">
                    <mydate asp-for="Rec.p91DateMaturity"></mydate>
                </div>

                <label class="col-sm-1 col-md-2 col-form-label">@_f.tra("Režijní přirážka k faktuře"):</label>
                <div class="col-sm-4 col-md-3">
                    <mycombo entity="p63Overhead" asp-for="Rec.p63ID" selectedtext="@Model.ComboP63Name"></mycombo>
                </div>
                <label class="col-sm-1 col-md-1 col-form-label">@_f.tra("DPH region"):</label>
                <div class="col-sm-2 col-md-2">
                    <mycombo entity="j17Country" asp-for="Rec.j17ID" selectedtext="@Model.ComboJ17Name"></mycombo>
                </div>
            </div>

            <div class="form-floating my-2">
                <textarea class="form-control" asp-for="Rec.p91Text1"></textarea>
                <label for="Rec_p90Text1">@_f.tra("Text faktury")</label>
            </div>
            <div class="form-floating my-2">
                <textarea class="form-control" asp-for="Rec.p91Text2"></textarea>
                <label for="Rec_p90Text2">@_f.tra("Technický text faktury")</label>
            </div>

            <div class="row my-2">
                <label class="col-auto col-form-label">@_f.tra("Období vyúčtovaných úkonů od"):</label>
                <div class="col-auto">
                    <mydate asp-for="Rec.p91Datep31_From"></mydate>
                </div>

                <label class="col-auto col-form-label">@_f.tra("Do"):</label>
                <div class="col-auto">
                    <mydate asp-for="Rec.p91Datep31_Until"></mydate>
                </div>
            </div>

        </div>

        <div class="tab-pane" id="tab2" role="tabpanel">
            <!-- Tab2 -->
            @Html.EditorFor(m => m.ff1, "~/Views/Shared/_FreeFields.cshtml")

        </div>
    </div>
</div>


<input type="hidden" asp-for="@Model.Rec.p91Code" value="@Model.Rec.p91Code" />
<input type="hidden" asp-for="@Model.CanEditRecordCode" />

<script type="text/javascript">
    $(document).ready(function () {




    });




    function postback() {
        form1.action = _ep("/p91/Record?oper=postback");
        form1.submit();
    }

    
    function hardrefresh(pid, flag) {
        if (flag != undefined) {
            if (flag.includes("recordcode")) {
                $("#Rec_p91Code").val(flag.split("|")[1]);
            }

        }


        postback("postback");
    }

</script>
